import { Meta, Props, Preview, Story } from '@storybook/addon-docs/blocks';
import {boolean, select, text} from '@storybook/addon-knobs';
import { Container, Row, Col } from 'storybook/blocks/grid';
import { ComponentHeader } from 'storybook/blocks/component-header';

import { Button } from '../../button/src';
import { Typography } from '../../typography/src';

import { Modal } from './Component';
import { ModalMobile } from './Component.mobile';
import { ModalDesktop } from './Component.desktop';
import { ModalResponsive } from './Component.responsive';

import { version } from '../package.json';


<Meta
    title='Компоненты/Modal'
    component={Modal}
    parameters={{ 'theme-switcher': { themes: ['click'] } }}
/>

<!-- Canvas -->

export const footerContent = (
    <div style={{ display: 'flex', flexDirection: 'column' }}>
        <Button size='s' view='primary' style={{ marginBottom: '24px' }}>Сохранить</Button>
        <Button size='s' view='secondary'>Отмена</Button>
    </div>
);

export const Content = () => {
    const [showMore, setShowMore] = React.useState(false);
    const Text = () => (
        <p>
            Сейчас много говорят об отказах банков в проведении операций, блокировках интернет-банка.
            Это связано с тем, что Центральный банк РФ обязывает банки выявлять операции своих клиентов,
            потенциально нарушающие требования Федерального закона «О противодействии легализации (отмыванию) доходов,
            полученных преступным путем, и финансированию терроризма» — 115-ФЗ
        </p>
    );
    return (
        <>
            <Text/>
            {showMore && (
                <>
                    <Text/>
                    <Text/>
                    <Text/>
                </>
            )}
            <Button size='xs' type='Button' onClick={() => setShowMore(!showMore)}>
                {showMore ? 'Hide' : 'Show'} more
            </Button>
        </>
    );
};

<Story name='ModalMobile'>
    {React.createElement(() => {
        const [open, setOpen] = React.useState(false);
        const handleModalOpen = () => setOpen(!open);
        return (
            <React.Fragment>
                <Button type='button' size='xs' onClick={handleModalOpen}>Open Modal</Button>
                <ModalMobile
                    open={open}
                    onClose={handleModalOpen}
                    headerContent={text('headerContent', 'Заголовок окна')}
                    footer={boolean('footer', false) && footerContent}
                    hasCloser={boolean('closer', true)}
                    keepMounted={boolean('keepMounted', false)}
                    disableBackdropClick={boolean('disableBackdropClick', false)}
                    disableEscapeKeyDown={boolean('disableEscapeKeyDown', false)}
                    disableRestoreFocus={boolean('disableRestoreFocus', false)}
                    disableFocusLock={boolean('disableFocusLock', false)}
                    disableAutoFocus={boolean('disableAutoFocus', false)}
                >
                    <div>
                        <h3>Заголовок контента</h3>
                        <Content />
                    </div>
                </ModalMobile>
            </React.Fragment>
        );
    })}
</Story>


<Story name='ModalDesktop'>
    {React.createElement(() => {
        const [open, setOpen] = React.useState(false);
        const handleModalOpen = () => setOpen(!open);
        return (
            <React.Fragment>
                <Button type='button' size='xs' onClick={handleModalOpen}>Open Modal</Button>
                <ModalDesktop
                    open={open}
                    onClose={handleModalOpen}
                    headerContent={text('headerContent', 'Заголовок окна')}
                    footer={boolean('footer', false) && footerContent}
                    hasCloser={boolean('closer', true)}
                    fullscreen={boolean('fullscreen', false)}
                    stickyHeader={boolean('stickyHeader', false)}
                    stickyFooter={boolean('stickyFooter', false)}
                    size={select('size', ['s', 'm', 'l'], 's')}
                    keepMounted={boolean('keepMounted', false)}
                    disableBackdropClick={boolean('disableBackdropClick', false)}
                    disableEscapeKeyDown={boolean('disableEscapeKeyDown', false)}
                    disableRestoreFocus={boolean('disableRestoreFocus', false)}
                    disableFocusLock={boolean('disableFocusLock', false)}
                    disableAutoFocus={boolean('disableAutoFocus', false)}
                >
                    <div>
                        <h3>Заголовок контента</h3>
                        <Content />
                    </div>
                </ModalDesktop>
            </React.Fragment>
        );
    })}
</Story>

<Story name='ModalResponsive'>
    {React.createElement(() => {
        const [open, setOpen] = React.useState(false);
        const handleModalOpen = () => setOpen(!open);
        return (
            <React.Fragment>
                <Button type='button' size='xs' onClick={handleModalOpen}>Open Modal</Button>
                <ModalResponsive
                    open={open}
                    onClose={handleModalOpen}
                    headerContent={text('headerContent', 'Заголовок окна')}
                    footer={boolean('footer', false) && footerContent}
                    hasCloser={boolean('closer', true)}
                    fullscreen={boolean('fullscreen', false)}
                    stickyHeader={boolean('stickyHeader', false)}
                    stickyFooter={boolean('stickyFooter', false)}
                    size={select('size', ['s', 'm', 'l'], 's')}
                    keepMounted={boolean('keepMounted', false)}
                    disableBackdropClick={boolean('disableBackdropClick', false)}
                    disableEscapeKeyDown={boolean('disableEscapeKeyDown', false)}
                    disableRestoreFocus={boolean('disableRestoreFocus', false)}
                    disableFocusLock={boolean('disableFocusLock', false)}
                    disableAutoFocus={boolean('disableAutoFocus', false)}
                >
                    <div>
                        <h3>Заголовок контента</h3>
                        <Content />
                    </div>
                </ModalResponsive>
            </React.Fragment>
        );
    })}
</Story>


<!-- Docs -->

<ComponentHeader
    name='Modal'
    version={version}
    package='@alfalab/core-components-modal'
    stage={1}
/>


```tsx
import { Modal } from '@alfalab/core-components-modal';
```

Компонент `Modal`.

<Props components={{
    ModalDesktop,
    ModalMobile,
    ModalResponsive
}} />


<Preview>
    <Container>
        <Row>
            <Typography.Title view="small">Шапка</Typography.Title>
        </Row>
        <Row>
            <Col>
                {React.createElement(() => {
                    const [open, setOpen] = React.useState(false);
                    const handleModalOpen = () => setOpen(!open);
                    return (
                        <React.Fragment>
                            <Button type='button' size='xs' onClick={handleModalOpen}>С заголовком</Button>
                            <ModalResponsive
                                open={open}
                                onClose={handleModalOpen}
                                headerContent='Заголовок окна'
                            >
                                <Content />
                            </ModalResponsive>
                        </React.Fragment>
                    );
                })}
            </Col>
            <Col>
                {React.createElement(() => {
                    const [open, setOpen] = React.useState(false);
                    const handleModalOpen = () => setOpen(!open);
                    return (
                        <React.Fragment>
                            <Button type='button' size='xs' onClick={handleModalOpen}>Без заголовка</Button>
                            <ModalResponsive
                                open={open}
                                onClose={handleModalOpen}
                            >
                                <Content />
                            </ModalResponsive>
                        </React.Fragment>
                    );
                })}
            </Col>
            <Col>
                {React.createElement(() => {
                    const [open, setOpen] = React.useState(false);
                    const handleModalOpen = () => setOpen(!open);
                    return (
                        <React.Fragment>
                            <Button type='button' size='xs' onClick={handleModalOpen}>Без шапки</Button>
                            <ModalResponsive
                                open={open}
                                onClose={handleModalOpen}
                                hasCloser={false}
                            >
                                <Content />
                            </ModalResponsive>
                        </React.Fragment>
                    );
                })}
            </Col>
            <Col>
                {React.createElement(() => {
                    const [open, setOpen] = React.useState(false);
                    const handleModalOpen = () => setOpen(!open);
                    return (
                        <React.Fragment>
                            <Button type='button' size='xs' onClick={handleModalOpen}>Sticky шапка</Button>
                            <ModalResponsive
                                open={open}
                                onClose={handleModalOpen}
                                stickyHeader={true}
                                headerContent='Заголовок окна'
                            >
                                <Content />
                            </ModalResponsive>
                        </React.Fragment>
                    );
                })}
            </Col>
            <Col>
                {React.createElement(() => {
                    const [open, setOpen] = React.useState(false);
                    const handleModalOpen = () => setOpen(!open);
                    return (
                        <React.Fragment>
                            <Button type='button' size='xs' onClick={handleModalOpen}>Sticky шапка (только крестик)</Button>
                            <ModalResponsive
                                open={open}
                                onClose={handleModalOpen}
                                stickyHeader={true}
                            >
                                <Content />
                            </ModalResponsive>
                        </React.Fragment>
                    );
                })}
            </Col>
        </Row>
        <Row>
            <Typography.Title view="small">Футер</Typography.Title>
        </Row>
        <Row>
            <Col>
                {React.createElement(() => {
                    const [open, setOpen] = React.useState(false);
                    const handleModalOpen = () => setOpen(!open);
                    return (
                        <React.Fragment>
                            <Button type='button' size='xs' onClick={handleModalOpen}>С футером</Button>
                            <ModalResponsive
                                open={open}
                                onClose={handleModalOpen}
                                footer={footerContent}
                            >
                                <Content />
                            </ModalResponsive>
                        </React.Fragment>
                    );
                })}
            </Col>
            <Col>
                {React.createElement(() => {
                    const [open, setOpen] = React.useState(false);
                    const handleModalOpen = () => setOpen(!open);
                    return (
                        <React.Fragment>
                            <Button type='button' size='xs' onClick={handleModalOpen}>Sticky футер</Button>
                            <ModalResponsive
                                open={open}
                                onClose={handleModalOpen}
                                footer={footerContent}
                                stickyFooter={true}
                            >
                                <Content />
                            </ModalResponsive>
                        </React.Fragment>
                    );
                })}
            </Col>
            <Col>
                {React.createElement(() => {
                    const [open, setOpen] = React.useState(false);
                    const handleModalOpen = () => setOpen(!open);
                    return (
                        <React.Fragment>
                            <Button type='button' size='xs' onClick={handleModalOpen}>Sticky футер и шапка</Button>
                            <ModalResponsive
                                open={open}
                                onClose={handleModalOpen}
                                headerContent='Заголовок окна'
                                footer={footerContent}
                                stickyFooter={true}
                                stickyHeader={true}
                            >
                                <Content />
                            </ModalResponsive>
                        </React.Fragment>
                    );
                })}
            </Col>
        </Row>
        <Row>
            <Typography.Title view="small">Fullscreen (шапка и футер всегда sticky)</Typography.Title>
        </Row>
        <Row>
            <Col>
                {React.createElement(() => {
                    const [open, setOpen] = React.useState(false);
                    const handleModalOpen = () => setOpen(!open);
                    return (
                        <React.Fragment>
                            <Button type='button' size='xs' onClick={handleModalOpen}>С футером</Button>
                            <ModalResponsive
                                open={open}
                                onClose={handleModalOpen}
                                footer={footerContent}
                                fullscreen={true}
                            >
                                <Content />
                            </ModalResponsive>
                        </React.Fragment>
                    );
                })}
            </Col>
            <Col>
                {React.createElement(() => {
                    const [open, setOpen] = React.useState(false);
                    const handleModalOpen = () => setOpen(!open);
                    return (
                        <React.Fragment>
                            <Button type='button' size='xs' onClick={handleModalOpen}>Без футера</Button>
                            <ModalResponsive
                                open={open}
                                onClose={handleModalOpen}
                                fullscreen={true}
                            >
                                <Content />
                            </ModalResponsive>
                        </React.Fragment>
                    );
                })}
            </Col>
        </Row>
    </Container>
</Preview>
