import { useState } from 'react';
import { Meta, Story, Props, Preview, Title } from '@storybook/addon-docs/blocks';
import { text, select, number, boolean } from '@storybook/addon-knobs';
import { Design } from 'storybook/blocks/design';

import { Confirmation } from './component';
import { name, version } from '../package.json';

<Meta title='Компоненты|Confirmation' component={Confirmation} />

<Title>
    Confirmation ({name}@{version})
</Title>

```tsx
import { Confirmation } from '@alfalab/core-components-confirmation';
```

## Описание

Компонент обратного отсчета для SMS подтверждения.

<Story name='Песочница'>
    {React.createElement(() => {
        const [error, setError] = useState('');
        const [codeSending, setCodeSending] = useState(false);
        const [codeChecking, setCodeChecking] = useState(false);
        const [errorIsFatal, setErrorIsFatal] = useState(false);
        const [code, setCode] = useState('');
        const handleSubmit = () => {
            setCodeChecking(true);
            setError('');
            setErrorIsFatal(false);
            setTimeout(() => {
                // setCodeChecking(false);
                // setError('Неправильный код');
                setCodeChecking(false);
                setError('Срок подписания кодом истёк. Пожалуйста, выполните операцию заново');
                setErrorIsFatal(true);
            }, 1500);
        };
        const handleSmsRetryClick = () => {
            setCodeSending(true);
            setError('');
            setErrorIsFatal(false);
            setTimeout(() => {
                setCodeSending(false);
            }, 1500);
        };
        const handleInputChange = (code) => {
            setCode(code);
            if (error) {
                setError('')
            }
        }
        return (
            <div style={{display: 'flex', width: '100%', maxWidth: '375px', padding: '15px', boxSizing: 'border-box'}}>
                <Confirmation
                    phone='+7 000 000 00 42'
                    onInputFinished={handleSubmit}
                    onSmsRetryClick={handleSmsRetryClick}
                    codeSending={codeSending}
                    codeChecking={codeChecking}
                    error={error}
                    errorIsFatal={errorIsFatal}
                    countdownDuration={5000}
                    value={code}
                    onInputChange={handleInputChange}
                />
            </div>
        );
    })}
</Story>

<Props of={Confirmation} />
