import { startOfMonth, startOfDay, subMonths, addMonths } from 'date-fns';
import { Preview } from '@storybook/addon-docs/blocks';

import { CalendarInput } from '../Component'
import { parseDateString, formatDate } from '../utils';
import styles from '../stories.module.css';

Компонент для ввода даты.

<Preview>
    {React.createElement(() => {
        const defaultMonth = new Date('December 1, 2010 00:00:00');
        return (
            <CalendarInput label='Дата регистрации' defaultMonth={defaultMonth} />
        );
    })}
</Preview>


### Controlled-way

Компонент может быть использован как controlled с помощью `onChange` и `selected`:

<Preview>
    {React.createElement(() => {
        const [value, setValue] = React.useState('');
        const handleChange = (event, { value }) => setValue(value);
        return (
            <CalendarInput
                value={value}
                onChange={handleChange}
                label='Дата регистрации'
            />
        );
    })}
</Preview>


### Рендер календаря под инпутом

Календарь может рендериться как в поповере, так и под инпутом

<Preview>
    {React.createElement(() => {
        const [value, setValue] = React.useState('');
        const handleChange = (event, { value }) => setValue(value);
        return (
            <CalendarInput
                value={value}
                onChange={handleChange}
                label='Дата регистрации'
                calendarPosition='static'
            />
        );
    })}
</Preview>


### Минимальная и максимальная дата

Календарь может рендериться как в поповере, так и под инпутом

<Preview>
    {React.createElement(() => {
        const minDate = subMonths(startOfDay(new Date()), 2).getTime();
        const maxDate = addMonths(startOfDay(new Date()), 2).getTime();
        const [error, setError] = React.useState('');
        const [value, setValue] = React.useState('');
        const handleChange = (event, { value }) => {
            setValue(value);
        }
        const handleBlur = (event) => {
            if (value) {
                const date = parseDateString(value);
                if (Number.isNaN(date.getTime()) || date < minDate || date > maxDate) setError('Некорректная дата');
            }
        }
        const handleFocus = () => setError('');
        return (
            <CalendarInput
                label='Дата регистрации'
                value={value}
                onChange={handleChange}
                onBlur={handleBlur}
                onFocus={handleFocus}
                minDate={minDate}
                maxDate={maxDate}
                error={error}
            />
        );
    })}
</Preview>


### Инпут по ширине календаря

Используя css-переменную `--calendar-width` можно задать инпуту такую же ширину, как у компонента календаря


<Preview>
    {/*
        .calendarWidth {
            width: var(--calendar-width);
        }
    */}
    <CalendarInput className={styles.calendarWidth} />
</Preview>
